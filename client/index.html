<!doctype html>
<html>
  <head>
    <title>Session Example</title>
    <meta charset="utf-8">
  </head>
  <body>

    <form id="login-form" name="login-form">
      <div>
        <label for="username">Username: </label>
        <input type="text" name="username" id="username">
      </div>
      <input type="submit" name="login" id="login" value="Login">
    </form>

    <form id="logout-form">
      <input type="submit" name="logout" id="logout" value="Logout">
    </form>

    <script>
      const loginForm = document.getElementById('login-form');
      const logoutForm = document.getElementById('logout-form');

      function login(e) {
        e.preventDefault();
        
        let data = {};
        data.username = document.getElementById('username').value;
        console.log(data);

        let myHeaders = new Headers();
        myHeaders.append('Content-Type', 'application/json');

        fetch('/login', {
          method: 'POST',
          headers: myHeaders,
          mode: 'cors',
          credentials: 'include',
          body: JSON.stringify(data)
        })
          .then((res) => {
            return res.json();
          })
          .then((data) => {
            console.log(data);
          });
      }

      function logout(e) {
        e.preventDefault();
        fetch('/logout', {
          method: 'POST',
          credentials: 'include',
          body: loginForm
        })
          .then((res) => {
            return res.json();
          })
          .then((data) => {
            console.log(data);
            if (data.error) {
              console.log('There was an error...');
            }
          });
      }

      loginForm.addEventListener('submit', login);
      logoutForm.addEventListener('submit', logout);
    </script>
  </body>
</html>